<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="employee_payslip_menu_template" name="payslip menu"
              inherit_id="inf_employee_portal.employee_list_template">
        <t t-call="portal.portal_layout">
            <t t-set="my_details" t-value="True"/>
            <xpath expr="//div[@id='o_portal_doc_spinner']" position="after">
                <div class="o_portal_category row g-2 mt-3" id="portal_payslip_category">
                    <t t-call="portal.portal_docs_entry">
                        <t t-set="icon" t-value="'/loyal_portal_payslip_generate/static/description/payslip.png'"/>
                        <t t-set="title">Payslip</t>
                        <t t-set="text">Generate your payslips</t>
                        <t t-set="url" t-value="'/my/employees/payslip'"/>
                        <t t-set="config_card" t-value="True"/>
                    </t>
                </div>
            </xpath>
        </t>
    </template>
<!--    <template id="employee_payslip_form" name="Payslip Form">-->
<!--        <t t-call="portal.portal_layout">-->
<!--            <div class="o_portal_my_home">-->
<!--                <div class="oe_structure" id="oe_structure_portal_my_home_1"/>-->
<!--                <div class="o_portal_docs row g-2">-->
<!--                    <div class="o_portal_doc_spinner spinner-border text-o-color-2 align-self-center mt-5"/>-->
<!--                    <p class="o_portal_no_doc_message d-none">No Documents to display</p>-->
<!--                    <div class="o_portal_category row g-2" id="portal_common_category">-->
<!--                        <form method="post" action="/my/payslip" enctype="multipart/form-data">-->
<!--                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>-->

<!--                            <div class="form-group mb-3">-->
<!--                                <label for="month">Select Month:</label>-->
<!--                                <select id="month" name="month" class="form-control">-->
<!--                                    <option value="select">-->
<!--                                        Select-->
<!--                                    </option>-->
<!--                                    <t t-foreach="months" t-as="month">-->
<!--                                        <option t-att-value="month">-->
<!--                                            <t t-esc="month"/>-->
<!--                                        </option>-->
<!--                                    </t>-->
<!--                                </select>-->
<!--                            </div>-->
<!--                            <div class="form-group mb-3">-->
<!--                                <label for="month">Select Year:</label>-->
<!--                                <select id="year" name="year" class="form-control">-->
<!--                                    <option value="select">-->
<!--                                        Select-->
<!--                                    </option>-->
<!--                                    <t t-foreach="years" t-as="year">-->
<!--                                        <option t-att-value="year">-->
<!--                                            <t t-esc="year"/>-->
<!--                                        </option>-->
<!--                                    </t>-->
<!--                                </select>-->
<!--                            </div>-->

<!--                            <a t-attf-href="/my/employee_list" class="btn btn-primary">Cancel</a>-->
<!--                            <button type="submit" class="btn btn-primary">Submit</button>-->
<!--                        </form>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </t>-->
<!--    </template>-->
    <template id="portal_my_payslips" name="My Payslips">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>

            <t t-call="portal.portal_searchbar">
                <t t-set="title">Your Payslips</t>
            </t>
            <div t-if="not payslips" class="alert alert-warning" role="alert">
                There are currently no payslips for your account.
            </div>
            <form method="post" action="/my/employees/payslip" enctype="multipart/form-data">
                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                    <div class="form-group mb-3">
                        <label for="month">Select Month:</label>
                        <select id="month" name="month" class="form-control">
                            <option value="select">
                                Select
                            </option>
                            <t t-foreach="months" t-as="month">
                                <option t-att-value="month">
                                    <t t-esc="month"/>
                                </option>
                            </t>
                        </select>
                    </div>
                    <div class="form-group mb-3">
                        <label for="month">Select Year:</label>
                        <select id="year" name="year" class="form-control">
                            <option value="select">
                                Select
                            </option>
                            <t t-foreach="years" t-as="year">
                                <option t-att-value="year">
                                    <t t-esc="year"/>
                                </option>
                            </t>
                        </select>
                    </div>
                    <a t-attf-href="/my/employee_list" class="btn btn-primary">Cancel</a>
                    &amp;nbsp;&amp;nbsp;
                    <button type="submit" class="btn btn-primary">Submit</button>
                </form>
                <br/><br/>
            <t t-if="payslips" t-call="portal.portal_table">
                <thead>
                    <tr class="active">
                        <th>
                            <span class='d-none d-md-inline'>Payslip #</span>
                            <span class='d-block d-md-none'>Ref.</span>
                        </th>
                        <th class="text-end">Period</th>
                        <th class="text-end">Download</th>
                    </tr>
                </thead>
                <t t-foreach="payslips" t-as="slip">
                    <tr>
                        <td>
                            <a t-attf-href="/my/payslip/print/{{slip.get('id')}}">
                                <t t-out="slip.get('display_name')"/>
                            </a>
                        </td>
                        <td class="text-end">
                            <t t-out="slip.get('from')"/>
                            -
                            <t t-out="slip.get('to')"/>
                        </td>
                        <td class="text-end">
                            <a class="btn btn-primary fa fa-download"
                               t-attf-href="/my/payslip/print/{{slip.get('id')}}">&amp;nbsp;Download
                            </a>
                            <!--                            <a class="btn btn-primary" t-att-href="'/website/download_pdf/%s' %slip.get('attachment')">-->
                            <!--                                Download PDF-->
                            <!--                            </a>-->
                        </td>
                    </tr>
                </t>
            </t>
            <p t-else="">There are currently no payslips for your account.</p>
        </t>
    </template>
    <template id="portal_my_payslip" name="Payslip">
        <t t-call="portal.portal_layout">
            <div class="pdf-display">
                <a class="btn btn-primary" t-att-href="'/website/download_pdf/%s' %attachment.id">Download PDF</a>
                <br/>
                <br/>
                <iframe src="/loyal_portal_payslip_generate/static/description/test.pdf"
                        width="100%" height="800px"
                        frameborder="0"></iframe>
            </div>
        </t>
    </template>
</odoo>